FROM kalilinux/kali-rolling:latest

# Update and install testing tools
RUN apt-get update && apt-get install -y \
    # Web testing tools
    nikto \
    sqlmap \
    hydra \
    nmap \
    dirb \
    gobuster \
    wfuzz \
    # Performance testing tools
    apache2-utils \
    siege \
    httperf \
    # Network tools
    hping3 \
    netcat-traditional \
    tcpdump \
    # Development tools
    python3 \
    python3-pip \
    python3-requests \
    git \
    curl \
    wget \
    vim \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Install Python packages for testing
RUN pip3 install --no-cache-dir \
    requests \
    beautifulsoup4 \
    paramiko \
    scapy \
    slowloris \
    mechanize \
    selenium \
    faker \
    httpx \
    asyncio \
    aiohttp

# Install Vegeta for high-performance load testing
RUN wget https://github.com/tsenart/vegeta/releases/download/v12.11.1/vegeta_12.11.1_linux_amd64.tar.gz \
    && tar -xzf vegeta_12.11.1_linux_amd64.tar.gz \
    && mv vegeta /usr/local/bin/ \
    && rm vegeta_12.11.1_linux_amd64.tar.gz

# Install slowhttptest
RUN git clone https://github.com/shekyan/slowhttptest.git \
    && cd slowhttptest \
    && ./configure \
    && make \
    && make install \
    && cd .. \
    && rm -rf slowhttptest

# Create testing directories
RUN mkdir -p /tests /results /wordlists

# Copy common wordlists
RUN wget -O /wordlists/common.txt https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/common.txt \
    && wget -O /wordlists/sqli.txt https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/SQLi/Generic-SQLi.txt \
    && wget -O /wordlists/xss.txt https://raw.githubusercontent.com/danielmiessler/SecLists/master/Fuzzing/XSS/XSS-Bypass-Strings-BruteLogic.txt

# Set working directory
WORKDIR /tests

# Keep container running
CMD ["tail", "-f", "/dev/null"]